language: node_js
os: linux
node_js: 11
cache:
  yarn: true
  directories:
  - $HOME/.cache/pip
services:
- xvfb
- docker
install:
- docker pull continuumio/miniconda3
- yarn
script:
- xvfb-run docker run -i -t -v $(pwd):/project -v ~/.cache/pip:/root/.cache/pip continuumio/miniconda3 /bin/bash -c "chown -R root /root/.cache && pip install tox-conda && cd /project && tox -e py37"
- cp testfiles-*/dump.reaxc.html docs/.vuepress/public/report.html 
- yarn docs:build
deploy:
  provider: pages
  skip-cleanup: true
  local_dir: docs/.vuepress/dist
  github-token: $GITHUB_TOKEN
  keep-history: true
  on:
    branch: master
